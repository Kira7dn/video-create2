[pytest]
# Cấu hình đường dẫn
pythonpath = .
testpaths = test
python_files = test_*.py
python_classes = Test*
python_functions = test_*

# Cấu hình logging
log_cli = true
log_cli_level = INFO
log_cli_format = %(asctime)s [%(levelname)8s] %(message)s (%(filename)s:%(lineno)s)
log_cli_date_format = %Y-%m-%d %H:%M:%S
; Không tạo file log mặc định
log_file =
log_file_level =
log_file_format =
log_file_date_format =

# Load variables from .env so SDKs expecting env vars can see them
dotenv_load_dotenv = true
dotenv_path = .env

# Các markers
markers =
    integration: marks tests as integration tests (requires external services)
    adapters: marks tests for infrastructure adapters (assets, renderer, uploader)
    pipeline: marks tests for application pipeline orchestration flows
    e2e: marks tests for end-to-end flows

# Tùy chọn chạy test
addopts =
    -v
    ; --maxfail=3
    --cov=app
    --cov=utils
    --cov-report=term-missing
    --cov-report=html:test/test_output/coverage
    --junitxml=test/test_output/junit/test-results.xml
    --log-cli-level=INFO

# Cấu hình thời gian
timeout = 600  # Thời gian timeout mặc định cho test (giây)
durations = 10  # Thông báo khi test chạy quá lâu

# Xử lý song song
numprocesses = 1  # Số lượng test chạy song song tối đa

# Bỏ qua cảnh báo
filterwarnings =
    ignore::DeprecationWarning
    ignore::UserWarning
    ignore::ResourceWarning
